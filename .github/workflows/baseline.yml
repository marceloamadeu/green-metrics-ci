name: 01-Baseline (Sequencial)
on: 
  workflow_dispatch:

jobs:
  test-baseline:
    runs-on: self-hosted
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Install Dependencies
        run: |
          # Usa o pip do sistema ou do venv se estiver ativo
          pip install -r requirements.txt

      - name: Iniciar Medição (Eco-CI)
        uses: green-coding-solutions/eco-ci-energy-estimation@v4
        with:
          task: start-measurement
          label: 'baseline-run'

      - name: Rodar Testes (Sequencial)
        run: |
          # Roda todos os testes um após o outro
          pytest src/test_app.py

      - name: Coletar Métricas
        uses: green-coding-solutions/eco-ci-energy-estimation@v4
        with:
          task: get-measurement
          label: 'baseline-tests'
          
      - name: Exibir Resultados
        uses: green-coding-solutions/eco-ci-energy-estimation@v4
        with:
          task: display-results
          json-output: true # Salva JSON para ser coletado depois